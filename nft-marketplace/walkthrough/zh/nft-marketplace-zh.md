# NFTå¸‚åœºåˆçº¦å­¦ä¹ å†…å®¹

Day: Day 26
ID: 26
åŸæ–‡: https://www.notion.so/NFT-Marketplace-1df5720a23ef8040b753eacf7bd9beb4?source=copy_link
çŠ¶æ€: å®Œæˆ
è¯‘è€…: Bala Chen
éš¾åº¦ç­‰çº§: é«˜çº§

å˜¿å˜¿ï¼Œæ¬¢è¿å›åˆ°**30å¤©Solidityå­¦ä¹ **â€”â€”æ¯å¤©ï¼Œä½ ä¸ä»…é€šè¿‡é˜…è¯»æ™ºèƒ½åˆçº¦çš„å·¥ä½œåŸç†æ¥å‡çº§ï¼Œè€Œæ˜¯é€šè¿‡å®é™…æ„å»ºæ„Ÿè§‰åƒçœŸå®ä¸–ç•Œåº”ç”¨çš„ä¸œè¥¿ã€‚

ä»Šå¤©ï¼Œæˆ‘ä»¬ä»**é“¸é€ NFT**è½¬å‘**å°†å®ƒä»¬è´§å¸åŒ–**ã€‚

è¿™ä¸ä»…ä»…æ˜¯ç»ƒä¹ ã€‚

è¿™æ˜¯ä½ æ„å»ºçœŸå®äº§å“çš„ç¬¬ä¸€æ­¥ã€‚

å¯ä»¥åœ¨ä¸»ç½‘ä¸Šè¿è¡Œçš„ä¸œè¥¿ã€‚ä½ æœ€å–œæ¬¢çš„NFTè‰ºæœ¯å®¶å¯ä»¥ç”¨æ¥åˆ—å‡ºä»–ä»¬ä½œå“çš„ä¸œè¥¿ã€‚

ä»Šå¤©...

ä½ æ­£åœ¨æ„å»ºè‡ªå·±çš„**NFTå¸‚åœº**ã€‚

---

### ğŸ›ï¸ è®©æˆ‘ä»¬è°ˆè°ˆå¸‚åœº

æƒ³æƒ³ä½ æœ€å–œæ¬¢çš„åœ¨çº¿å¸‚åœºâ€”â€”ä¹Ÿè®¸æ˜¯OpenSeaï¼Œä¹Ÿè®¸æ˜¯æ·˜å®ï¼Œä¹Ÿè®¸æ˜¯ä½ é™„è¿‘çš„è·³èš¤å¸‚åœºã€‚

æ€»æ˜¯æœ‰ç›¸åŒçš„3ä¸ªè§’è‰²ï¼š

- æœ‰äºº**å‡ºå”®**æœ‰ä»·å€¼çš„ä¸œè¥¿
- æœ‰äºº**è´­ä¹°**å®ƒ
- ä¸­é—´æœ‰ä¸€ä¸ªå¹³å°å¤„ç†äº¤æ˜“ï¼ŒæŠ½å–ä½£é‡‘ï¼Œå¹¶ç§»åŠ¨å•†å“

ç°åœ¨æŠŠè¿™ä¸ªæƒ³æ³•â€”â€”å®Œå…¨æ”¾åœ¨é“¾ä¸Šã€‚

æ²¡æœ‰ä¸­é—´äººã€‚æ²¡æœ‰åç«¯ã€‚æ²¡æœ‰äººé˜»æŒ¡é“è·¯ã€‚

åªæ˜¯ä¸€ä¸ªæ™ºèƒ½åˆçº¦ï¼š

- åˆ—å‡ºNFT
- å¤„ç†ETHæ”¯ä»˜
- æ”¯ä»˜ç»™å–å®¶ã€å¹³å°ï¼Œç”šè‡³åŸåˆ›è€…â€”â€”**è‡ªåŠ¨åœ°**

---

### ğŸ§  ä¸ºä»€ä¹ˆè¿™ä¸ªé¡¹ç›®å¾ˆé‡è¦

NFTå¸‚åœºæ˜¯ä¸€åˆ‡æ±‡èšçš„åœ°æ–¹ï¼š

- ERC721é€»è¾‘ âœ…
- å®‰å…¨çš„ETHè½¬è´¦ âœ…
- åˆ›ä½œè€…ç‰ˆç¨ âœ…
- è´¹ç”¨åˆ†é… âœ…
- é‡å…¥ä¿æŠ¤ âœ…
- æ‰€æœ‰æƒ+æ‰¹å‡†æµç¨‹ âœ…

è¿™æ˜¯å±•ç¤ºçœŸå®ä¸–ç•Œé‡ŒWeb3åº”ç”¨å¦‚ä½•åœ¨åº•å±‚å·¥ä½œçš„åˆçº¦ç±»å‹ã€‚

å½“ä½ æ„å»ºè¿™ä¸ªæ—¶...ä½ ä¸ä»…ä»…æ˜¯åœ¨å¤åˆ¶OpenSeaã€‚

ä½ åœ¨ç†è§£å®ƒâ€”â€”å¹¶åˆ›å»ºä½ è‡ªå·±çš„ç²¾ç®€ç‰ˆã€ä¸è‡ƒè‚¿ç‰ˆæœ¬ã€‚

ä¸€ä¸ª**ä½ æ§åˆ¶**çš„ç‰ˆæœ¬ã€‚

---

### ğŸ§¾ ä½ ä»Šå¤©å°†å­¦åˆ°ä»€ä¹ˆ

- å¦‚ä½•**åˆ—å‡º**å¸¦æœ‰è‡ªå®šä¹‰ä»·æ ¼å’Œå¯é€‰ç‰ˆç¨çš„NFT
- å¦‚ä½•ä½¿ç”¨ETH**è´­ä¹°**NFTï¼ˆè‡ªåŠ¨åˆ†é…ç»™å–å®¶ã€åˆ›ä½œè€…å’Œå¸‚åœºï¼‰
- å¦‚æœå–å®¶æ”¹å˜ä¸»æ„ï¼Œå¦‚ä½•**å–æ¶ˆåˆ—å‡º**NFT
- å¦‚ä½•ä½¿ç”¨`ReentrancyGuard`**ä¿æŠ¤**ä¸€åˆ‡
- ä»¥åŠå¦‚ä½•ä½œä¸ºåˆçº¦æ‰€æœ‰è€…**è·Ÿè¸ªå’Œæ›´æ–°è´¹ç”¨**å¹¶æ‹¥æœ‰å®Œå…¨æ§åˆ¶æƒ

---

### ğŸ’¡ æ˜¯ä»€ä¹ˆè®©è¿™ä¸ªç‰¹åˆ«ï¼Ÿ

è¿™ä¸ªå¸‚åœºä¸ä»…è®©äººä»¬äº¤æ˜“NFTã€‚å®ƒï¼š

- å°Šé‡åˆ›ä½œè€…ç‰ˆç¨
- è‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰æƒ
- ç¡®ä¿æ¯ä¸ªäººéƒ½å¾—åˆ°æ­£ç¡®çš„æŠ¥é…¬ï¼ˆå–å®¶ã€åˆ›ä½œè€…å’Œä½ ï¼ï¼‰
- ä¸éœ€è¦**åç«¯**å’Œ**ä¿¡ä»»**â€”â€”ä¸€åˆ‡éƒ½ç”±ä»£ç æ‰§è¡Œ

ä½ ä¸æ˜¯åœ¨æ„å»ºä¸€ä¸ª*å‡è£…*åšäº‹æƒ…çš„UIã€‚

ä½ åœ¨æ„å»ºå®é™…*åš*è¿™äº›äº‹æƒ…çš„åç«¯é€»è¾‘â€”â€”å®æ—¶ï¼Œåœ¨é“¾ä¸Šã€‚

---

### ğŸš€ åˆ°æœ€å

ä½ å°†æ‹¥æœ‰ä¸€ä¸ªè‡ªåŒ…å«çš„NFTå¸‚åœºåˆçº¦ï¼Œå¯ä»¥ï¼š

- åˆ—å‡ºä»»ä½•ERC-721
- ç”¨ETHå‡ºå”®å®ƒ
- åˆ†é…è´¹ç”¨
- å®‰å…¨åœ°è½¬ç§»NFT
- ç”¨äº‹ä»¶è®°å½•æ‰€æœ‰æ´»åŠ¨ï¼Œä¾›å‰ç«¯è·å–

è¿™å°±åƒä½ è‡ªå·±çš„å°OpenSeaâ€”â€”ä½†æŒ‰ä½ çš„æ¡ä»¶ã€‚

# äº§å“éœ€æ±‚è¯´æ˜

ç”¨æˆ·æµç¨‹

```mermaid
flowchart TD
  A(éƒ¨ç½²åˆçº¦) --> B{åˆå§‹åŒ–æ ¡éªŒ}
  B -->|è´¹ç”¨ â‰¤ 1000bp| C(è®¾ç½®æ‰€æœ‰è€…/è´¹ç”¨æ¥æ”¶è€…/è´¹ç‡)
  B -->|æ— æ•ˆå‚æ•°| X1(éƒ¨ç½²å›é€€)

  C --> D(è®¾ç½®å¹³å°è´¹ç‡)
  C --> E(è®¾ç½®è´¹ç”¨æ¥æ”¶åœ°å€)
  C --> F(åˆ—å‡ºNFT)
  C --> G(è´­ä¹°NFT)
  C --> H(å–æ¶ˆåˆ—è¡¨)
  C --> I(æŸ¥è¯¢åˆ—è¡¨)
  C --> J(æ‹’ç»ç›´æ¥ETH)
  C --> K(æ‹’ç»æœªçŸ¥å‡½æ•°)

  D --> D1{ä»…é™æ‰€æœ‰è€…}
  D1 -->|æ–°è´¹ç‡ â‰¤ 1000bp| D2(æ›´æ–°è´¹ç‡å¹¶è§¦å‘äº‹ä»¶)
  D1 -->|ä¸åˆæ³•| X2(è®¾ç½®è´¹ç‡å›é€€)

  E --> E1{ä»…é™æ‰€æœ‰è€…}
  E1 -->|æ¥æ”¶åœ°å€ â‰  é›¶åœ°å€| E2(æ›´æ–°æ¥æ”¶è€…å¹¶è§¦å‘äº‹ä»¶)
  E1 -->|ä¸åˆæ³•| X3(è®¾ç½®æ¥æ”¶è€…å›é€€)

  F --> F1{åŸºæœ¬æ ¡éªŒ}
  F1 -->|ä»·æ ¼ > 0| F2
  F1 -->|ç‰ˆç¨ â‰¤ 1000bp| F2
  F1 -->|å°šæœªåˆ—å‡º| F2
  F1 -->|å¦åˆ™| X4(åˆ—å‡ºå›é€€)
  F2 --> F3{æ‰€æœ‰æƒä¸æˆæƒ}
  F3 -->|ownerOf == è°ƒç”¨è€…| F4
  F3 -->|å·²æ‰¹å‡†æˆ–å…¨å±€æˆæƒ| F4
  F3 -->|å¦åˆ™| X5(æˆæƒæ ¡éªŒå›é€€)
  F4 --> F5(å­˜å‚¨åˆ—è¡¨å¹¶è§¦å‘äº‹ä»¶)

  G --> G0[é˜²é‡å…¥ä¿æŠ¤]
  G0 --> G1{åˆ—è¡¨ä¸ä»˜æ¬¾æ ¡éªŒ}
  G1 -->|å·²åˆ—å‡º| G2
  G1 -->|msg.value == ä»·æ ¼| G2
  G1 -->|å¹³å°è´¹ + ç‰ˆç¨ â‰¤ 100%| G2
  G1 -->|å¦åˆ™| X6(è´­ä¹°å›é€€)
  G2 --> G3(è®¡ç®—å¹³å°è´¹/ç‰ˆç¨/å–å®¶æ”¶å…¥)
  G3 --> G4(è‹¥å¹³å°è´¹>0åˆ™æ”¯ä»˜æ¥æ”¶è€…)
  G4 --> G5(è‹¥ç‰ˆç¨>0ä¸”æœ‰æ¥æ”¶è€…åˆ™æ”¯ä»˜)
  G5 --> G6(æ”¯ä»˜å–å®¶)
  G6 --> G7(å®‰å…¨è½¬ç§»NFTç»™ä¹°å®¶)
  G7 --> G8(åˆ é™¤åˆ—è¡¨å¹¶è§¦å‘è´­ä¹°äº‹ä»¶)

  H --> H1{ä»…å–å®¶ä¸”å·²åˆ—å‡º}
  H1 -->|å·²åˆ—å‡º| H2
  H1 -->|è°ƒç”¨è€… == å–å®¶| H2
  H1 -->|å¦åˆ™| X7(å–æ¶ˆå›é€€)
  H2 --> H3(åˆ é™¤åˆ—è¡¨å¹¶è§¦å‘äº‹ä»¶)

  I --> I1(è¿”å›åˆ—è¡¨ç»“æ„ä½“)

  J --> X8(æ‹’æ”¶ç›´æ¥ETH)

  K --> X9(æ‹’æ”¶æœªçŸ¥è°ƒç”¨)

```

éœ€è¦çš„æ•°æ®ç»“æ„

| â”” Function Name | Visibility | Mutability |
| --- | --- | --- |
| constructor | Public | ğŸ›‘ |
| setMarketplaceFeePercent | External | âš™ï¸ |
| setFeeRecipient | External | âš™ï¸ |
| listNFT | External | âš™ï¸ |
| buyNFT | External | ğŸ›‘ |
| cancelListing | External | âš™ï¸ |
| getListing | External | View |
| receive | External | ğŸ›‘ |
| fallback | External | ğŸ›‘ |

# ç»†èŠ‚è§£è¯´

## ğŸ§¾ æ¦‚è¿°ï¼šè¿™ä¸ªNFTå¸‚åœºåˆçº¦å¦‚ä½•å·¥ä½œ

é‚£ä¹ˆæˆ‘ä»¬çœŸæ­£åœ¨æ„å»ºä»€ä¹ˆï¼Ÿ

è¿™ä¸ªåˆçº¦æ˜¯ä¸€ä¸ª**å®Œå…¨é“¾ä¸Šçš„NFTå¸‚åœº**ï¼Œç”¨çº¯Solidityç¼–å†™ã€‚å®ƒè®©äººä»¬ï¼š

- **åˆ—å‡ºä»–ä»¬çš„NFTå‡ºå”®**ï¼Œè®¾ç½®ä»·æ ¼ç”šè‡³è‡ªå®šä¹‰ç‰ˆç¨
- é€šè¿‡ç›´æ¥å‘åˆçº¦å‘é€ETHæ¥**è´­ä¹°NFT**
- **è‡ªåŠ¨åˆ†å‰²é”€å”®**åœ¨å–å®¶ã€åˆ›ä½œè€…ï¼ˆç‰ˆç¨ï¼‰å’Œå¹³å°ï¼ˆå¸‚åœºè´¹ç”¨ï¼‰ä¹‹é—´
- éšæ—¶**å–æ¶ˆåˆ—è¡¨**
- ä½œä¸ºå¸‚åœºæ‰€æœ‰è€…**æ›´æ–°è´¹ç”¨è®¾ç½®**

æ‰€æœ‰è¿™äº›éƒ½**å®‰å…¨åœ°**å‘ç”Ÿï¼Œå…·æœ‰å†…ç½®ä¿æŠ¤ï¼Œå¦‚`ReentrancyGuard`æ¥é˜²æ­¢æ”»å‡»ã€‚

è¿™é‡Œæ²¡æœ‰å‰ç«¯ï¼Œæ²¡æœ‰JavaScriptï¼Œæ²¡æœ‰åç«¯æ•°æ®åº“â€”â€”åªæ˜¯ä¸€ä¸ªæ™ºèƒ½åˆçº¦ï¼š

- è·Ÿè¸ªæ¯ä¸ªåˆ—è¡¨
- éªŒè¯æ¯ä¸ªNFTå’Œå–å®¶
- æ­£ç¡®ç§»åŠ¨ETHå’ŒNFT
- å‘å‡ºäº‹ä»¶ï¼Œä»¥ä¾¿UIå¯ä»¥è·Ÿéš

è¿™æ˜¯åƒ**OpenSea**å’Œ**LooksRare**è¿™æ ·çš„å¹³å°æ„å»ºçš„ç›¸åŒåŸºç¡€â€”â€”ä½†æ›´å¹²å‡€ã€æ›´ç®€å•ã€å¯¹åˆå­¦è€…å‹å¥½ã€‚

## ğŸ§¾ å®Œæ•´çš„NFTå¸‚åœºåˆçº¦ä»£ç 

```solidity

// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "@openzeppelin/contracts/token/ERC721/IERC721.sol";
import "@openzeppelin/contracts/security/ReentrancyGuard.sol";

contract NFTMarketplace is ReentrancyGuard {
    address public owner;
    uint256 public marketplaceFeePercent; // ä»¥åŸºç‚¹ä¸ºå•ä½ (100 = 1%)
    address public feeRecipient;

    struct Listing {
        address seller;
        address nftAddress;
        uint256 tokenId;
        uint256 price;
        address royaltyReceiver;
        uint256 royaltyPercent; // ä»¥åŸºç‚¹ä¸ºå•ä½
        bool isListed;
    }

    mapping(address => mapping(uint256 => Listing)) public listings;

    event Listed(
        address indexed seller,
        address indexed nftAddress,
        uint256 indexed tokenId,
        uint256 price,
        address royaltyReceiver,
        uint256 royaltyPercent
    );

    event Purchase(
        address indexed buyer,
        address indexed nftAddress,
        uint256 indexed tokenId,
        uint256 price,
        address seller,
        address royaltyReceiver,
        uint256 royaltyAmount,
        uint256 marketplaceFeeAmount
    );

    event Unlisted(
        address indexed seller,
        address indexed nftAddress,
        uint256 indexed tokenId
    );

    event FeeUpdated(
        uint256 newMarketplaceFee,
        address newFeeRecipient
    );

    constructor(uint256 _marketplaceFeePercent, address _feeRecipient) {
        require(_marketplaceFeePercent <= 1000, "Marketplace fee too high (max 10%)");
        require(_feeRecipient != address(0), "Fee recipient cannot be zero");

        owner = msg.sender;
        marketplaceFeePercent = _marketplaceFeePercent;
        feeRecipient = _feeRecipient;
    }

    modifier onlyOwner() {
        require(msg.sender == owner, "Only owner");
        _;
    }

    function setMarketplaceFeePercent(uint256 _newFee) external onlyOwner {
        require(_newFee <= 1000, "Marketplace fee too high");
        marketplaceFeePercent = _newFee;
        emit FeeUpdated(_newFee, feeRecipient);
    }

    function setFeeRecipient(address _newRecipient) external onlyOwner {
        require(_newRecipient != address(0), "Invalid fee recipient");
        feeRecipient = _newRecipient;
        emit FeeUpdated(marketplaceFeePercent, _newRecipient);
    }

    function listNFT(
        address nftAddress,
        uint256 tokenId,
        uint256 price,
        address royaltyReceiver,
        uint256 royaltyPercent
    ) external {
        require(price > 0, "Price must be above zero");
        require(royaltyPercent <= 1000, "Max 10% royalty allowed");
        require(!listings[nftAddress][tokenId].isListed, "Already listed");

        IERC721 nft = IERC721(nftAddress);
        require(nft.ownerOf(tokenId) == msg.sender, "Not the owner");
        require(
            nft.getApproved(tokenId) == address(this) || nft.isApprovedForAll(msg.sender, address(this)),
            "Marketplace not approved"
        );

        listings[nftAddress][tokenId] = Listing({
            seller: msg.sender,
            nftAddress: nftAddress,
            tokenId: tokenId,
            price: price,
            royaltyReceiver: royaltyReceiver,
            royaltyPercent: royaltyPercent,
            isListed: true
        });

        emit Listed(msg.sender, nftAddress, tokenId, price, royaltyReceiver, royaltyPercent);
    }

    function buyNFT(address nftAddress, uint256 tokenId) external payable nonReentrant {
        Listing memory item = listings[nftAddress][tokenId];
        require(item.isListed, "Not listed");
        require(msg.value == item.price, "Incorrect ETH sent");
        require(
            item.royaltyPercent + marketplaceFeePercent <= 10000,
            "Combined fees exceed 100%"
        );

        uint256 feeAmount = (msg.value * marketplaceFeePercent) / 10000;
        uint256 royaltyAmount = (msg.value * item.royaltyPercent) / 10000;
        uint256 sellerAmount = msg.value - feeAmount - royaltyAmount;

        // å¸‚åœºè´¹ç”¨
        if (feeAmount > 0) {
            payable(feeRecipient).transfer(feeAmount);
        }

        // åˆ›ä½œè€…ç‰ˆç¨
        if (royaltyAmount > 0 && item.royaltyReceiver != address(0)) {
            payable(item.royaltyReceiver).transfer(royaltyAmount);
        }

        // å–å®¶æ”¯ä»˜
        payable(item.seller).transfer(sellerAmount);

        // å°†NFTè½¬ç§»ç»™ä¹°å®¶
        IERC721(item.nftAddress).safeTransferFrom(item.seller, msg.sender, item.tokenId);

        // åˆ é™¤åˆ—è¡¨
        delete listings[nftAddress][tokenId];

        emit Purchase(
            msg.sender,
            nftAddress,
            tokenId,
            msg.value,
            item.seller,
            item.royaltyReceiver,
            royaltyAmount,
            feeAmount
        );
    }

    function cancelListing(address nftAddress, uint256 tokenId) external {
        Listing memory item = listings[nftAddress][tokenId];
        require(item.isListed, "Not listed");
        require(item.seller == msg.sender, "Not the seller");

        delete listings[nftAddress][tokenId];
        emit Unlisted(msg.sender, nftAddress, tokenId);
    }

    function getListing(address nftAddress, uint256 tokenId) external view returns (Listing memory) {
        return listings[nftAddress][tokenId];
    }

    receive() external payable {
        revert("Direct ETH not accepted");
    }

    fallback() external payable {
        revert("Unknown function");
    }
}

```

---

## 1. ğŸ“¦ å¯¼å…¥â€”â€”å¼•å…¥å¯ä¿¡çš„æ„å»ºå—

```solidity

import "@openzeppelin/contracts/token/ERC721/IERC721.sol";
import "@openzeppelin/contracts/security/ReentrancyGuard.sol";

```

è¿™ä¸¤è¡Œæ˜¯ä»OpenZeppelinåˆçº¦åº“**å¼•å…¥å¼ºå¤§çš„ã€ç»è¿‡å®æˆ˜æµ‹è¯•çš„ç»„ä»¶**ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬çš„ä½œç”¨ï¼š

---

### âœ… `IERC721`

```solidity

import "@openzeppelin/contracts/token/ERC721/IERC721.sol";

```

è¿™å¼•å…¥äº†ä»»ä½•ERC-721 NFTçš„**æ¥å£**â€”â€”è¿™æ˜¯éåŒè´¨åŒ–ä»£å¸ï¼ˆNFTï¼‰ä½¿ç”¨çš„æ ‡å‡†ã€‚

æŠŠ`IERC721`æƒ³è±¡æˆå®šä¹‰ä»¥ä¸‹å†…å®¹çš„åˆçº¦è“å›¾ï¼š

- è°æ‹¥æœ‰ä»£å¸ï¼ˆ`ownerOf`ï¼‰
- å¦‚ä½•å®‰å…¨å‘é€ä»£å¸ï¼ˆ`safeTransferFrom`ï¼‰
- å¦‚ä½•æ‰¹å‡†æŸäººè½¬ç§»ä½ çš„NFTï¼ˆ`approve`ã€`isApprovedForAll`ç­‰ï¼‰

é€šè¿‡å¯¼å…¥è¿™ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥**ä¸ä»»ä½•NFTåˆçº¦äº¤äº’**â€”â€”ä¸ä»…ä»…æ˜¯æˆ‘ä»¬åˆ›å»ºçš„NFTï¼Œè€Œæ˜¯*ä»»ä½•ERC-721å…¼å®¹åˆçº¦*ï¼Œæ¯”å¦‚æ— èŠçŒ¿æˆ–è‡ªå®šä¹‰æ¸¸æˆå†…ç‰©å“ã€‚

> ğŸ§  æˆ‘ä»¬è¿™é‡Œä¸éœ€è¦å®Œæ•´çš„NFTåˆçº¦â€”â€”æˆ‘ä»¬ä¸æ˜¯åœ¨åˆ›å»ºNFTã€‚
> 
> 
> æˆ‘ä»¬åªæ˜¯**ä¸ç°æœ‰NFTä¸€èµ·å·¥ä½œ**ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ¥å£æ¥è°ƒç”¨å®ƒä»¬çš„å‡½æ•°ã€‚
> 

---

### ğŸ›¡ï¸ `ReentrancyGuard`

```solidity

import "@openzeppelin/contracts/security/ReentrancyGuard.sol";

```

è¿™æ˜¯ä¸€ä¸ª**å®‰å…¨å·¥å…·**ï¼Œå¸®åŠ©ä¿æŠ¤æˆ‘ä»¬çš„åˆçº¦å…å—ç§°ä¸º**é‡å…¥æ”»å‡»**çš„å¸¸è§é»‘å®¢æ”»å‡»ã€‚

é‚£æ˜¯ä»€ä¹ˆï¼Ÿ

> æƒ³è±¡æœ‰äººå¼€å§‹è´­ä¹°NFTï¼Œåœ¨è¯¥äº¤æ˜“å®Œæˆä¹‹å‰ï¼Œä»–ä»¬å·å·è¿›å…¥å¦ä¸€ä¸ªï¼ˆæˆ–ä¸€ç³»åˆ—äº¤æ˜“ï¼‰ï¼Œæä¹±ä½™é¢å¹¶è€—å°½èµ„é‡‘ã€‚
> 

é€šè¿‡ä½¿ç”¨`ReentrancyGuard`ï¼Œæˆ‘ä»¬å¯ä»¥**é”å®šæˆ‘ä»¬çš„æ•æ„Ÿå‡½æ•°**ï¼Œå¦‚`buyNFT()`ï¼Œè¿™æ ·æ²¡æœ‰äººå¯ä»¥é‡æ–°è¿›å…¥å¹¶åœ¨ä¸­é€”åˆ©ç”¨é€»è¾‘ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨`nonReentrant`ä¿®é¥°ç¬¦åº”ç”¨è¿™ä¸ªä¿æŠ¤ã€‚

---

## 2. ğŸ—ï¸ åˆçº¦å£°æ˜â€”â€”å¯åŠ¨å¸‚åœº

```solidity

contract NFTMarketplace is ReentrancyGuard {

```

è¿™ä¸€è¡Œå¯åŠ¨äº†å®é™…çš„æ™ºèƒ½åˆçº¦â€”â€”å®ƒåšäº†**ä¸¤ä»¶å¤§äº‹**ï¼š

1. **å‘½åæˆ‘ä»¬çš„åˆçº¦**
    - å®ƒå«åš`NFTMarketplace`â€”â€”è¿™æ˜¯å…¶ä»–åˆçº¦ã€å·¥å…·å’Œå‰ç«¯å°†å¼•ç”¨å®ƒçš„æ–¹å¼ã€‚
2. **ä»ReentrancyGuardç»§æ‰¿**
    - é€šè¿‡è¿™æ ·åšï¼Œæˆ‘ä»¬çš„åˆçº¦*è‡ªåŠ¨è·å¾—ä¿æŠ¤*ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨`nonReentrant`ä¿®é¥°ç¬¦çš„ä»»ä½•å‡½æ•°ä¸Šå…å—é‡å…¥æ”»å‡»ã€‚
    - è¿™å°±åƒç»™æˆ‘ä»¬çš„æ•æ„Ÿå‡½æ•°ä¸€ä¸ªç§äººä¿é•–ã€‚

---

ğŸ”‘ ä¸ºä»€ä¹ˆè¿™ä¸ªè®¾ç½®å¾ˆé‡è¦

ä»…ä»…é€šè¿‡è¿™ä¸¤ä¸ªå¯¼å…¥å’Œå£°æ˜ï¼Œæˆ‘ä»¬å°±ä¸ºä»¥ä¸‹å†…å®¹å¥ å®šäº†åŸºç¡€ï¼š

- ä¸ä»»ä½•ERC-721 NFTåˆçº¦ä¸€èµ·å·¥ä½œ
- ä¿æŒæˆ‘ä»¬çš„å¸‚åœºå…å—å…³é”®æ¼æ´çš„å½±å“

ç°åœ¨æˆ‘ä»¬å‡†å¤‡æ·±å…¥**çŠ¶æ€å˜é‡**â€”â€”æˆ‘ä»¬çš„åˆçº¦å­˜å‚¨çš„æ•°æ®ï¼Œç”¨äºè·Ÿè¸ªåˆ—è¡¨ã€è´¹ç”¨å’Œæ‰€æœ‰æƒã€‚

## 3. çŠ¶æ€å˜é‡

è¿™äº›å˜é‡ä½äºåˆçº¦çš„é¡¶éƒ¨ï¼š

```solidity

address public owner;
uint256 public marketplaceFeePercent; // ä»¥åŸºç‚¹ä¸ºå•ä½ (100 = 1%)
address public feeRecipient;

```

---

**ğŸ§  è¿™äº›å˜é‡çš„ä½œç”¨**

è¿™ä¸‰ä¸ªå€¼ä¸ºæˆ‘ä»¬çš„å¸‚åœºæä¾›äº†**åŸºæœ¬çš„ç®¡ç†æ§åˆ¶å’Œæ”¶å…¥é€»è¾‘**ã€‚å®ƒä»¬å®šä¹‰ï¼š

- è°è´Ÿè´£
- å¸‚åœºæ”¶å–å¤šå°‘è´¹ç”¨
- è¿™äº›è´¹ç”¨å»å“ªé‡Œ

è®©æˆ‘ä»¬é€ä¸€åˆ†æï¼š

---

### ğŸ‘‘ `owner`

```solidity

address public owner;

```

- è¿™å­˜å‚¨äº†**éƒ¨ç½²åˆçº¦çš„åœ°å€**ã€‚
- æ‰€æœ‰è€…è¢«è®¤ä¸ºæ˜¯**ç®¡ç†å‘˜**â€”â€”å”¯ä¸€è¢«å…è®¸æ›´æ–°è´¹ç”¨æˆ–æ›´æ”¹è´¹ç”¨æ¥æ”¶è€…çš„äººã€‚

> ğŸ’¡ ä¸ºä»€ä¹ˆæ‰‹åŠ¨è·Ÿè¸ªæ‰€æœ‰æƒï¼Ÿ
> 
> 
> å› ä¸ºè¿™æ²¡æœ‰ä½¿ç”¨OpenZeppelinçš„`Ownable`åˆçº¦â€”â€”æˆ‘ä»¬ä¿æŒç²¾ç®€å¹¶ç¼–å†™è‡ªå·±çš„åŸºæœ¬è®¿é—®æ§åˆ¶ã€‚
> 

ä½ ç¨åä¼šåœ¨ä»£ç ä¸­çœ‹åˆ°ä¸€ä¸ªåä¸º`onlyOwner`çš„ä¿®é¥°ç¬¦ï¼Œå®ƒä½¿ç”¨è¿™ä¸ªå€¼ã€‚

---

### ğŸ’¸ `marketplaceFeePercent`

```solidity

uint256 public marketplaceFeePercent; // ä»¥åŸºç‚¹ä¸ºå•ä½ (100 = 1%)

```

è¿™è®¾ç½®äº†å¸‚åœºå°†ä»æ¯æ¬¡é”€å”®ä¸­æ”¶å–çš„**è´¹ç”¨ç™¾åˆ†æ¯”**â€”â€”ä½†ä»¥**åŸºç‚¹**ä¸ºå•ä½ã€‚

> ğŸ§¾ ä»€ä¹ˆæ˜¯åŸºç‚¹ï¼Ÿ
> 
> 
> 1åŸºç‚¹ = 0.01%ã€‚
> 
> æ‰€ä»¥100åŸºç‚¹ = 1%ã€‚
> 
> 1000åŸºç‚¹ = 10%ã€‚
> 

ä½¿ç”¨åŸºç‚¹ä¸ºæˆ‘ä»¬æä¾›äº†å¯¹è´¹ç”¨çš„**ç»†ç²’åº¦æ§åˆ¶**ï¼Œå¹¶é¿å…äº†Solidityç¼ºä¹å°æ•°çš„é—®é¢˜ã€‚

ä¾‹å¦‚ï¼š

- è´¹ç”¨ä¸º`250`æ„å‘³ç€æ¯æ¬¡é”€å”®çš„2.5%å½’å¸‚åœºæ‰€æœ‰ã€‚

è¿™ä¸ªå˜é‡ç¨åå¯ä»¥ç”±æ‰€æœ‰è€…æ›´æ–°ã€‚

---

### ğŸ¦ `feeRecipient`

```solidity

address public feeRecipient;

```

è¿™æ˜¯ä»æ¯æ¬¡NFTé”€å”®ä¸­**æ¥æ”¶å¸‚åœºä»½é¢**çš„**é’±åŒ…**ã€‚

å®ƒå¯èƒ½æ˜¯ï¼š

- å¸‚åœºåˆ›å§‹äºº
- DAOé‡‘åº“
- å¤šé‡ç­¾åé’±åŒ…
- ç”šè‡³æ˜¯è‡ªåŠ¨åˆ†é…èµ„é‡‘çš„æ™ºèƒ½åˆçº¦

---

## 4. ç»“æ„ä½“å’Œæ˜ å°„

ç°åœ¨æˆ‘ä»¬è¿›å…¥å¸‚åœºçš„**æ ¸å¿ƒæ•°æ®æ¨¡å‹**ï¼š**`Listing`ç»“æ„ä½“**å’Œå­˜å‚¨æ‰€æœ‰åˆ—å‡ºNFTçš„**æ˜ å°„**ã€‚

è¿™æ˜¯ä½ çš„å¸‚åœºè·Ÿè¸ªä»€ä¹ˆåœ¨å‡ºå”®ã€è°æ‹¥æœ‰å®ƒã€æˆæœ¬å¤šå°‘ä»¥åŠè°å¾—åˆ°ä»€ä¹ˆæŠ¥é…¬çš„åœ°æ–¹ã€‚

---

### ğŸ§± `Listing`ç»“æ„ä½“

```solidity

struct Listing {
    address seller;
    address nftAddress;
    uint256 tokenId;
    uint256 price;
    address royaltyReceiver;
    uint256 royaltyPercent; // ä»¥åŸºç‚¹ä¸ºå•ä½
    bool isListed;
}

```

è¿™ä¸ªç»“æ„ä½“å°±åƒåœ¨å¸‚åœºä¸Šåˆ—å‡ºçš„å•ä¸ªNFTçš„**è¿·ä½ æ•°æ®åº“æ¡ç›®**ã€‚

è®©æˆ‘ä»¬åˆ†è§£æ¯ä¸ªå­—æ®µï¼š

---

ğŸ§ `seller`

```solidity

address seller;

```

åˆ—å‡ºNFTçš„äººã€‚

ä»–ä»¬å°†æ˜¯æ¥æ”¶å¤§éƒ¨åˆ†ä»˜æ¬¾çš„äººï¼ˆåœ¨å¸‚åœºè´¹ç”¨å’Œç‰ˆç¨ä¹‹åï¼‰ã€‚

---

ğŸ–¼ï¸ `nftAddress`

```solidity

address nftAddress;

```

è¿™æ˜¯NFTçš„**åˆçº¦åœ°å€**ã€‚

ä½ çš„å¸‚åœºæ”¯æŒ*ä»»ä½•*ERC-721ä»£å¸â€”â€”ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ”¶è—â€”â€”æ‰€ä»¥æˆ‘ä»¬éœ€è¦çŸ¥é“**è¿™ä¸ªä»£å¸å±äºå“ªä¸ªNFTåˆçº¦**ã€‚

---

ğŸ·ï¸ `tokenId`

```solidity

uint256 tokenId;

```

è¢«åˆ—å‡ºçš„**NFTçš„ID**ã€‚

ä¸`nftAddress`ä¸€èµ·ï¼Œè¿™æŒ‡å‘åŒºå—é“¾ä¸Šçš„ç‰¹å®šNFTã€‚

---

ğŸ’° `price`

```solidity

uint256 price;

```

å–å®¶æƒ³è¦NFTçš„é‡‘é¢ï¼ˆä»¥**ETH**ä¸ºå•ä½ï¼‰ã€‚

å½“æœ‰äººè´­ä¹°å®ƒæ—¶ï¼Œä»–ä»¬éœ€è¦å‘é€ç¡®åˆ‡çš„è¿™ä¸ªETHæ•°é‡ã€‚

---

ğŸ¨ `royaltyReceiver`

```solidity

address royaltyReceiver;

```

å¯é€‰ï¼šåº”è¯¥ä»æ­¤æ¬¡é”€å”®ä¸­æ¥æ”¶**åˆ›ä½œè€…ç‰ˆç¨**çš„åœ°å€ã€‚

è¿™å…è®¸åˆ›ä½œè€…ç»§ç»­ä»äºŒæ¬¡é”€å”®ä¸­èµšé’±ï¼Œå³ä½¿ä»–ä»¬ä¸å†æ˜¯å–å®¶ã€‚

---

ğŸ“ˆ `royaltyPercent`

```solidity

uint256 royaltyPercent; // ä»¥åŸºç‚¹ä¸ºå•ä½

```

`royaltyReceiver`åº”è¯¥è·å¾—å¤šå°‘ç‰ˆç¨â€”â€”ä»¥åŸºç‚¹ä¸ºå•ä½ï¼ˆ1% = 100ï¼‰ã€‚

ä¾‹å­ï¼š

- å¦‚æœ`price = 1 ETH`ä¸”`royaltyPercent = 500`ï¼Œåˆ›ä½œè€…è·å¾—`0.05 ETH`ã€‚

> ğŸ¯ ä½ å¯ä»¥ä¸ºæ¯ä¸ªåˆ—è¡¨è‡ªå®šä¹‰è¿™ä¸ªâ€”â€”ä¸éœ€è¦åœ¨NFTåˆçº¦ä¸­çƒ˜ç„™å›ºå®šç‰ˆç¨ã€‚
> 

---

ğŸ“¦ `isListed`

```solidity

bool isListed;

```

å‘Šè¯‰æˆ‘ä»¬NFTæ˜¯å¦**å½“å‰åˆ—å‡º**çš„æ ‡å¿—ã€‚

æˆ‘ä»¬ç”¨è¿™ä¸ªæ¥ï¼š

- é˜²æ­¢é‡å¤åˆ—è¡¨
- æ£€æŸ¥æŸäº›ä¸œè¥¿æ˜¯å¦ä»åœ¨å‡ºå”®
- æ§åˆ¶åœ¨å¸‚åœºå‰ç«¯æ˜¾ç¤ºä»€ä¹ˆ

---

### ğŸ“š æ˜ å°„ï¼šå­˜å‚¨æ‰€æœ‰åˆ—è¡¨

```solidity

mapping(address => mapping(uint256 => Listing)) public listings;

```

è¿™æ˜¯æˆ‘ä»¬åœ¨åˆçº¦ä¸­**å­˜å‚¨å’Œç»„ç»‡**æ‰€æœ‰åˆ—è¡¨çš„æ–¹å¼ã€‚

è¿™æ˜¯ä¸€ä¸ª**åµŒå¥—æ˜ å°„**ï¼Œæ„å‘³ç€ï¼š

- ç¬¬ä¸€ä¸ªé”®æ˜¯**NFTåˆçº¦åœ°å€**
- ç¬¬äºŒä¸ªé”®æ˜¯**ä»£å¸ID**

æ‰€ä»¥å¦‚æœä½ æƒ³è®¿é—®ç‰¹å®šNFTçš„åˆ—è¡¨ï¼Œä½ ä¼šä½¿ç”¨ï¼š

```solidity

listings[nftAddress][tokenId]

```

> ğŸ’¡ ä¸ºä»€ä¹ˆåµŒå¥—ï¼Ÿ
> 
> 
> å› ä¸ºè¿™å…è®¸æ”¯æŒå¤šä¸ªä¸åŒçš„NFTæ”¶è—â€”â€”å…¨éƒ¨åœ¨ä¸€ä¸ªåˆçº¦ä¸­ã€‚å®ƒå¹²å‡€ã€å¯æ‰©å±•ï¼Œå¹¶ä¸”ä¸ä»»ä½•ERC-721éƒ½èƒ½å¾ˆå¥½åœ°å·¥ä½œã€‚
> 

## 5. ğŸ”” NFTå¸‚åœºä¸­çš„å…³é”®äº‹ä»¶

äº‹ä»¶èµ·åˆå¯èƒ½çœ‹èµ·æ¥åƒèƒŒæ™¯å™ªéŸ³...ä½†å®ƒä»¬å®é™…ä¸Šæ˜¯æ™ºèƒ½åˆçº¦ä¸å¤–éƒ¨ä¸–ç•Œå¯¹è¯çš„**ä¸»è¦æ–¹å¼**ã€‚

å½“é“¾ä¸Šå‘ç”ŸæŸäº‹æ—¶â€”â€”æ¯”å¦‚åˆ—å‡ºNFTæˆ–è¿›è¡Œé”€å”®â€”â€”æˆ‘ä»¬å‘å‡ºä¸€ä¸ª**äº‹ä»¶**ï¼Œä»¥ä¾¿ï¼š

- å‰ç«¯åº”ç”¨ï¼ˆå¦‚ä½ çš„å¸‚åœºUIï¼‰å¯ä»¥è·å–å¹¶æ˜¾ç¤ºå®ƒ
- ç´¢å¼•å™¨ï¼ˆå¦‚The Graphï¼‰å¯ä»¥è·Ÿè¸ªå’Œåˆ†ç±»å®ƒ
- å¼€å‘è€…å’Œç”¨æˆ·å¯ä»¥åœ¨åƒEtherscanè¿™æ ·çš„åŒºå—æµè§ˆå™¨ä¸ŠæŸ¥çœ‹å®ƒ

å®ƒä»¬ä¸å½±å“åˆçº¦å†…éƒ¨çš„é€»è¾‘â€”â€”ä½†å®ƒä»¬å¯¹**é€æ˜åº¦å’Œå¯ç”¨æ€§**è‡³å…³é‡è¦ã€‚

è¿™é‡Œæ˜¯åˆçº¦ä¸­å®šä¹‰çš„å››ä¸ªäº‹ä»¶ï¼š

```solidity

event Listed(
    address indexed seller,
    address indexed nftAddress,
    uint256 indexed tokenId,
    uint256 price,
    address royaltyReceiver,
    uint256 royaltyPercent
);

event Purchase(
    address indexed buyer,
    address indexed nftAddress,
    uint256 indexed tokenId,
    uint256 price,
    address seller,
    address royaltyReceiver,
    uint256 royaltyAmount,
    uint256 marketplaceFeeAmount
);

event Unlisted(
    address indexed seller,
    address indexed nftAddress,
    uint256 indexed tokenId
);

event FeeUpdated(
    uint256 newMarketplaceFee,
    address newFeeRecipient
);

```

---

ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€ä¸€åˆ†è§£å®ƒä»¬ï¼š

---

âœ… 1. `Listed`

```solidity

event Listed(
    address indexed seller,
    address indexed nftAddress,
    uint256 indexed tokenId,
    uint256 price,
    address royaltyReceiver,
    uint256 royaltyPercent
);

```

å½“NFTè¢«**åˆ—å‡º**å‡ºå”®æ—¶å‘å‡ºæ­¤äº‹ä»¶ã€‚

å®ƒå‘Šè¯‰ä¸–ç•Œï¼š

- **è°**åˆ—å‡ºäº†å®ƒï¼ˆ`seller`ï¼‰
- **å“ªä¸ªNFT**æ­£åœ¨è¢«å‡ºå”®ï¼ˆ`nftAddress`ã€`tokenId`ï¼‰
- **å¤šå°‘é’±**ï¼ˆ`price`ï¼‰
- **è°è·å¾—ç‰ˆç¨**ï¼Œä»¥åŠ**å¤šå°‘**ï¼ˆ`royaltyReceiver`ã€`royaltyPercent`ï¼‰

`indexed`å­—æ®µä½¿å¾—åœ¨UIå’Œæµè§ˆå™¨å·¥å…·ä¸­æŒ‰å–å®¶æˆ–NFTè¿‡æ»¤åˆ—è¡¨å˜å¾—å®¹æ˜“ã€‚

---

ğŸ›ï¸ 2. `Purchase`

```solidity

event Purchase(
    address indexed buyer,
    address indexed nftAddress,
    uint256 indexed tokenId,
    uint256 price,
    address seller,
    address royaltyReceiver,
    uint256 royaltyAmount,
    uint256 marketplaceFeeAmount
);

```

å½“æœ‰äºº**è´­ä¹°NFT**æ—¶è§¦å‘æ­¤äº‹ä»¶ã€‚

å®ƒåŒ…æ‹¬ï¼š

- **ä¹°å®¶**çš„åœ°å€
- è¢«å‡ºå”®çš„**NFT**ï¼ˆé€šè¿‡`nftAddress`å’Œ`tokenId`ï¼‰
- æ”¯ä»˜çš„**æ€»ä»·æ ¼**
- æ¥æ”¶ETHçš„**å–å®¶**ï¼ˆå‡å»è´¹ç”¨ï¼‰
- **ç‰ˆç¨æ¥æ”¶è€…**ï¼ˆå¦‚æœæœ‰ï¼‰ä»¥åŠä»–ä»¬å¾—åˆ°å¤šå°‘
- **å¸‚åœºè´¹ç”¨é‡‘é¢**

è¿™æ˜¯æœ€è¯¦ç»†çš„äº‹ä»¶â€”â€”å®ƒè·Ÿè¸ª**äº¤æ˜“çš„æ¯ä¸ªéƒ¨åˆ†**ã€‚å¯¹ä»¥ä¸‹æœ‰ç”¨ï¼š

- å‰ç«¯æ˜¾ç¤ºè´­ä¹°æ”¶æ®
- æ˜¾ç¤ºå¸‚åœºæ”¶å…¥çš„åˆ†æä»ªè¡¨æ¿
- åˆ›ä½œè€…ç‰ˆç¨æŠ¥å‘Š

---

ğŸš« 3. `Unlisted`

```solidity

event Unlisted(
    address indexed seller,
    address indexed nftAddress,
    uint256 indexed tokenId
);

```

å½“å–å®¶**å–æ¶ˆ**ä»–ä»¬çš„åˆ—è¡¨æ—¶å‘å‡ºã€‚

è¿™ä¸ªäº‹ä»¶å¸®åŠ©ï¼š

- UIåœæ­¢æ˜¾ç¤ºè¿‡æœŸæˆ–åˆ é™¤çš„åˆ—è¡¨
- ç´¢å¼•å™¨æ›´æ–°ä»–ä»¬çš„æ•°æ®åº“
- æ¯ä¸ªäººéƒ½ä¿æŒå¯¹å®é™…å‡ºå”®å†…å®¹çš„åŒæ­¥

---

ğŸ› ï¸ 4. `FeeUpdated`

```solidity

event FeeUpdated(
    uint256 newMarketplaceFee,
    address newFeeRecipient
);

```

å½“**å¸‚åœºæ‰€æœ‰è€…æ›´æ”¹è´¹ç”¨è®¾ç½®**æ—¶è®°å½•æ­¤äº‹ä»¶ã€‚

è¿™åŒ…æ‹¬ï¼š

- **æ–°è´¹ç”¨**ï¼ˆä»¥åŸºç‚¹ä¸ºå•ä½ï¼Œä¾‹å¦‚250 = 2.5%ï¼‰
- è´¹ç”¨ETHå°†è¢«å‘é€åˆ°çš„**æ–°æ¥æ”¶è€…åœ°å€**

å®ƒä¸»è¦å¯¹ç®¡ç†é¢æ¿ã€DAOæ§åˆ¶çš„å¹³å°æˆ–ç”¨æˆ·é€æ˜åº¦æœ‰ç”¨ã€‚

---

## 6. ğŸ—ï¸æ„é€ å‡½æ•°â€”â€”å¼•å¯¼å¸‚åœº

```solidity

constructor(uint256 _marketplaceFeePercent, address _feeRecipient) {
    require(_marketplaceFeePercent <= 1000, "Marketplace fee too high (max 10%)");
    require(_feeRecipient != address(0), "Fee recipient cannot be zero");

    owner = msg.sender;
    marketplaceFeePercent = _marketplaceFeePercent;
    feeRecipient = _feeRecipient;
}

```

---

### **ğŸ§  ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ**

å½“æœ‰äººéƒ¨ç½²è¿™ä¸ªåˆçº¦æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ä»–ä»¬ï¼š

- è®¾ç½®å¸‚åœºå°†æ”¶å–å¤šå°‘**è´¹ç”¨**ï¼ˆä¾‹å¦‚ï¼Œ2.5%ï¼‰
- å†³å®šè¿™äº›è´¹ç”¨åº”è¯¥**å»å“ªé‡Œ**ï¼ˆä¾‹å¦‚ï¼Œåˆ°DAOé‡‘åº“æˆ–å¼€å‘é’±åŒ…ï¼‰
- è‡ªåŠ¨æˆä¸ºåˆçº¦çš„**æ‰€æœ‰è€…/ç®¡ç†å‘˜**

---

### ğŸ” é€è¡Œåˆ†è§£

âœ… è´¹ç”¨éªŒè¯

```solidity

require(_marketplaceFeePercent <= 1000, "Marketplace fee too high (max 10%)");

```

- é˜²æ­¢åœ¨éƒ¨ç½²æ—¶è®¾ç½®ç–¯ç‹‚çš„è´¹ç”¨è®¾ç½®ã€‚
- è´¹ç”¨ä»¥**åŸºç‚¹**ä¸ºå•ä½ï¼Œå…¶ä¸­ï¼š
    - `1000` = 10%
    - `500` = 5%
    - `250` = 2.5%
- è¿™ä¸€è¡Œç¡®ä¿éƒ¨ç½²è€…ä¸èƒ½è®¾ç½®åƒ99%è¿™æ ·è’è°¬çš„ä¸œè¥¿ã€‚

---

**âœ… è´¹ç”¨æ¥æ”¶è€…æ£€æŸ¥**

```solidity

require(_feeRecipient != address(0), "Fee recipient cannot be zero");

```

æˆ‘ä»¬ç¡®ä¿éƒ¨ç½²è€…ä¼ å…¥ä¸€ä¸ª**æœ‰æ•ˆçš„ETHåœ°å€**æ¥æ¥æ”¶å¸‚åœºè´¹ç”¨ã€‚

> å°†å…¶è®¾ç½®ä¸ºé›¶åœ°å€ï¼ˆ0x000...000ï¼‰ä¼šä½¿è´¹ç”¨æ°¸è¿œæ¶ˆå¤±â€”â€”æ‰€ä»¥æˆ‘ä»¬é˜»æ­¢è¿™ç§æƒ…å†µã€‚
> 

---

**ğŸ‘‘ è®¾ç½®æ‰€æœ‰è€…**

```solidity

owner = msg.sender;

```

éƒ¨ç½²åˆçº¦çš„äººæˆä¸º**ç®¡ç†å‘˜/æ‰€æœ‰è€…**ã€‚

ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼š

- åªæœ‰æ‰€æœ‰è€…å¯ä»¥æ›´æ–°è´¹ç”¨æˆ–æ›´æ”¹è´¹ç”¨æ¥æ”¶è€…
- è¿™æ˜¯ä½ è¯´"è¿™ä¸ªäººæ§åˆ¶å¸‚åœºè®¾ç½®"çš„æ–¹å¼

---

**ğŸ’° è®¾ç½®è´¹ç”¨è®¾ç½®**

```solidity

marketplaceFeePercent = _marketplaceFeePercent;
feeRecipient = _feeRecipient;

```

- `marketplaceFeePercent`ï¼šå¹³å°ä»æ¯æ¬¡é”€å”®ä¸­æ”¶å–å¤šå°‘
- `feeRecipient`ï¼šè´¹ç”¨å‘é€åˆ°å“ªé‡Œ

ä¸€æ—¦è®¾ç½®äº†è¿™äº›ï¼Œå¸‚åœºå°±å‡†å¤‡å¥½å¤„ç†åˆ—è¡¨å’Œé”€å”®äº†ã€‚

## 7. ğŸ›¡ï¸`onlyOwner`ä¿®é¥°ç¬¦â€”â€”é”å®šç®¡ç†å‡½æ•°

```solidity

modifier onlyOwner() {
    require(msg.sender == owner, "Only owner");
    _;
}

```

---

### **ğŸ§  ä»€ä¹ˆæ˜¯ä¿®é¥°ç¬¦ï¼Ÿ**

åœ¨Solidityä¸­ï¼Œ**ä¿®é¥°ç¬¦**å°±åƒå¯é‡ç”¨çš„ä¿æŠ¤å­å¥ã€‚

ä½ å¯ä»¥å°†å…¶é™„åŠ åˆ°å‡½æ•°ä¸Šï¼Œä»¥**åœ¨è¯¥å‡½æ•°è¿è¡Œä¹‹å‰è¦æ±‚æŸäº›æ¡ä»¶**ã€‚

å®ƒæœ‰åŠ©äºä¿æŒä½ çš„ä»£ç **å¹²å‡€**ã€**å¯é‡ç”¨**å’Œ**æ˜“äºé˜…è¯»**ã€‚

---

### ğŸ” é€è¡Œåˆ†è§£

---

**âœ… æ£€æŸ¥è°åœ¨è°ƒç”¨**

```solidity

require(msg.sender == owner, "Only owner");

```

è¿™ä¸€è¡Œç¡®ä¿å‡½æ•°**åªèƒ½ç”±æ‰€æœ‰è€…è°ƒç”¨**â€”â€”éƒ¨ç½²åˆçº¦çš„åœ°å€ã€‚

- `msg.sender`æ˜¯è¯•å›¾è°ƒç”¨å‡½æ•°çš„åœ°å€
- å¦‚æœå®ƒä¸ç­‰äº`owner`ï¼Œå‡½æ•°**ç«‹å³åœæ­¢**
- è¿”å›é”™è¯¯æ¶ˆæ¯`"Only owner"`

è¿™æ˜¯ä½ çš„**è®¿é—®æ§åˆ¶**æœºåˆ¶ã€‚

---

**ğŸ“¦ ç»§ç»­å‡½æ•°**

```solidity

_;

```

è¿™ä¸ªæœ‰è¶£çš„å°ä¸‹åˆ’çº¿æ„å‘³ç€ï¼š

> "å¦‚æœrequireæ£€æŸ¥é€šè¿‡ï¼Œç°åœ¨ç»§ç»­è¿è¡Œå‡½æ•°çš„å…¶ä½™éƒ¨åˆ†ã€‚"
> 

## 8. ğŸ’¸ `setMarketplaceFeePercent()` â€” æ›´æ–°å¸‚åœºè´¹ç”¨

```solidity

function setMarketplaceFeePercent(uint256 _newFee) external onlyOwner {
    require(_newFee <= 1000, "Marketplace fee too high");
    marketplaceFeePercent = _newFee;
    emit FeeUpdated(_newFee, feeRecipient);
}

```

---

### ğŸ§  å®ƒåšä»€ä¹ˆï¼Ÿ

è¿™ä¸ªå‡½æ•°å…è®¸**åˆçº¦çš„æ‰€æœ‰è€…**æ›´æ”¹**å¸‚åœºè´¹ç”¨**ï¼ˆå¹³å°åœ¨æ¯æ¬¡é”€å”®ä¸­æ”¶å–çš„ç™¾åˆ†æ¯”ï¼‰ã€‚

å®ƒå¯¹ä»¥ä¸‹æœ‰ç”¨ï¼š

- éšç€å¹³å°å¢é•¿è°ƒæ•´è´¹ç”¨
- åœ¨ä¿ƒé”€æœŸé—´é™ä½è´¹ç”¨
- å¢åŠ è´¹ç”¨ä»¥ç»´æŒè¿è¥
- å“åº”ç¤¾åŒºæ²»ç†ï¼Œå¦‚æœç”±DAOè¿è¡Œ

---

### ğŸ” é€è¡Œåˆ†è§£

**ğŸ” è®¿é—®é™åˆ¶**

```solidity

external onlyOwner

```

- `external`ï¼šæ„å‘³ç€è¿™ä¸ªå‡½æ•°æ˜¯ä¸ºäº†ä»åˆçº¦å¤–éƒ¨è°ƒç”¨ï¼ˆæ¯”å¦‚é€šè¿‡å‰ç«¯æˆ–ç”±æ‰€æœ‰è€…ç›´æ¥è°ƒç”¨ï¼‰ã€‚
- `onlyOwner`ï¼šç¡®ä¿**åªæœ‰ç®¡ç†å‘˜**å¯ä»¥è°ƒç”¨å®ƒâ€”â€”æ„Ÿè°¢æˆ‘ä»¬åˆšåˆšä»‹ç»çš„ä¿®é¥°ç¬¦ã€‚

---

**âœ… è¾“å…¥æ£€æŸ¥**

```solidity

require(_newFee <= 1000, "Marketplace fee too high");

```

- é˜²æ­¢è®¾ç½®ä¸åˆç†çš„é«˜è´¹ç”¨ã€‚
- è´¹ç”¨ä»¥**åŸºç‚¹**ä¸ºå•ä½ï¼Œæ‰€ä»¥ï¼š
    - `1000` = 10%
    - `100` = 1%
- å¦‚æœ`_newFee`å¤§äº1000ï¼Œäº¤æ˜“è¢«å›æ»šã€‚

è¿™é˜²æ­¢å¸‚åœºå˜å¾—æ»¥ç”¨æˆ–ä¸å¯ç”¨ã€‚

---

**ğŸ“ æ›´æ–°çŠ¶æ€**

```solidity

marketplaceFeePercent = _newFee;

```

è¿™è®¾ç½®æ–°å€¼ï¼Œæ›´æ–°åœ¨æ‰€æœ‰æœªæ¥é”€å”®ä¸­ä½¿ç”¨çš„**å…¨å±€è´¹ç”¨ç™¾åˆ†æ¯”**ã€‚

å®ƒ**ä¸**å½±å“ç°æœ‰åˆ—è¡¨â€”â€”åªå½±å“æœªæ¥çš„è´­ä¹°ã€‚

---

**ğŸ“¢ å‘å‡ºäº‹ä»¶**

```solidity

emit FeeUpdated(_newFee, feeRecipient);

```

è¿™è§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œä»¥ä¾¿ï¼š

- å‰ç«¯å¯ä»¥è·å–æ›´æ”¹å¹¶æ›´æ–°UI
- å®¡è®¡å‘˜å’Œç”¨æˆ·å¯ä»¥çœ‹åˆ°è´¹ç”¨è¢«æ›´æ”¹äº†
- ä½ ä¸ºæ¯æ¬¡è´¹ç”¨è°ƒæ•´è·å¾—é“¾ä¸Šé€æ˜åº¦

---

## 9. ğŸ¦  `setFeeRecipient()` â€” æ›´æ–°å¸‚åœºè´¹ç”¨å»å‘

```solidity

function setFeeRecipient(address _newRecipient) external onlyOwner {
    require(_newRecipient != address(0), "Invalid fee recipient");
    feeRecipient = _newRecipient;
    emit FeeUpdated(marketplaceFeePercent, _newRecipient);
}

```

---

### **ğŸ§  è¿™æ˜¯ä¸ºäº†ä»€ä¹ˆï¼Ÿ**

åœ¨ä»»ä½•NFTå¸‚åœºä¸­ï¼Œ**è´¹ç”¨æ¥æ”¶è€…**æ˜¯æ”¶é›†å¸‚åœºæ¯æ¬¡é”€å”®ä»½é¢çš„åœ°å€ã€‚

è¿™å¯èƒ½æ˜¯ï¼š

- **åˆ›å§‹äººçš„é’±åŒ…**
- **DAOé‡‘åº“**
- å›¢é˜Ÿç®¡ç†çš„**å¤šé‡ç­¾å**
- ç”šè‡³æ˜¯è¿›ä¸€æ­¥åˆ†å‰²æ”¶å…¥çš„**æ™ºèƒ½åˆçº¦**

è¿™ä¸ªå‡½æ•°è®©å¸‚åœº**éšæ—¶é—´é€‚åº”**â€”â€”æ— è®ºæ˜¯ä¸ºäº†å®‰å…¨å‡çº§ã€å»ä¸­å¿ƒåŒ–ï¼Œè¿˜æ˜¯å°†æ”¶å…¥è½¬ç§»åˆ°ç¤¾åŒºæ§åˆ¶çš„åˆçº¦ã€‚

---

### ğŸ” é€è¡Œåˆ†è§£

**ğŸ” é™åˆ¶ä¸ºæ‰€æœ‰è€…**

```solidity

external onlyOwner

```

å°±åƒä¹‹å‰ä¸€æ ·ï¼š

- `external` = åªèƒ½ä»åˆçº¦å¤–éƒ¨è°ƒç”¨
- `onlyOwner` = **åªæœ‰ç®¡ç†å‘˜**å¯ä»¥æ›´æ–°è´¹ç”¨æ¥æ”¶è€…

---

**âœ… éªŒè¯æ–°åœ°å€**

```solidity

require(_newRecipient != address(0), "Invalid fee recipient");

```

- æ£€æŸ¥æ–°åœ°å€**ä¸æ˜¯**é›¶åœ°å€ï¼ˆ`0x000...000`ï¼‰ã€‚
- å¦‚æœæ˜¯ï¼Œæˆ‘ä»¬å›æ»šäº¤æ˜“ä»¥é¿å…æ„å¤–"ç‡ƒçƒ§"æœªæ¥è´¹ç”¨ã€‚

> è¿™æ˜¯ä¸€ä¸ªç®€å•ä½†é‡è¦çš„ä¿æŠ¤æªæ–½ã€‚
> 

---

**ğŸ“ ä¿å­˜æ–°åœ°å€**

```solidity

feeRecipient = _newRecipient;

```

æˆ‘ä»¬æ›´æ–°åˆçº¦çš„å†…éƒ¨çŠ¶æ€â€”â€”ç°åœ¨æ‰€æœ‰æœªæ¥çš„å¸‚åœºè´¹ç”¨å°†è¢«å‘é€åˆ°è¿™ä¸ªæ–°åœ°å€ã€‚

---

**ğŸ“¢ å‘å‡ºæ›´æ–°äº‹ä»¶**

```solidity

emit FeeUpdated(marketplaceFeePercent, _newRecipient);

```

è¿™é‡ç”¨äº†`FeeUpdated`äº‹ä»¶â€”â€”å³ä½¿åªæœ‰æ¥æ”¶è€…æ”¹å˜äº†ã€‚

è¿™æœ‰åŠ©äºï¼š

- å‰ç«¯ç«‹å³åæ˜ æ›´æ”¹
- ç´¢å¼•å™¨è·Ÿè¸ªç®¡ç†æ“ä½œ
- ç”¨æˆ·çŸ¥é“è´¹ç”¨å»å“ªé‡Œ--
- 

## 10. ğŸ·ï¸ `listNFT()` â€” åˆ—å‡ºä½ çš„NFTå‡ºå”®

```solidity

function listNFT(
    address nftAddress,
    uint256 tokenId,
    uint256 price,
    address royaltyReceiver,
    uint256 royaltyPercent
) external {
    require(price > 0, "Price must be above zero");
    require(royaltyPercent <= 1000, "Max 10% royalty allowed");
    require(!listings[nftAddress][tokenId].isListed, "Already listed");

    IERC721 nft = IERC721(nftAddress);
    require(nft.ownerOf(tokenId) == msg.sender, "Not the owner");
    require(
        nft.getApproved(tokenId) == address(this) || nft.isApprovedForAll(msg.sender, address(this)),
        "Marketplace not approved"
    );

    listings[nftAddress][tokenId] = Listing({
        seller: msg.sender,
        nftAddress: nftAddress,
        tokenId: tokenId,
        price: price,
        royaltyReceiver: royaltyReceiver,
        royaltyPercent: royaltyPercent,
        isListed: true
    });

    emit Listed(msg.sender, nftAddress, tokenId, price, royaltyReceiver, royaltyPercent);
}

```

---

### **ğŸ§  å®ƒåšä»€ä¹ˆï¼Ÿ**

è¿™ä¸ªå‡½æ•°å…è®¸ä»»ä½•ç”¨æˆ·**åˆ—å‡ºä»–ä»¬æ‹¥æœ‰çš„NFT**åœ¨å¸‚åœºä¸Šå‡ºå”®ã€‚

å®ƒæ£€æŸ¥ï¼š

- ç”¨æˆ·æ‹¥æœ‰NFT
- NFTè¢«æ‰¹å‡†ç”¨äºå¸‚åœºè½¬ç§»
- ä»·æ ¼å’Œç‰ˆç¨è®¾ç½®æœ‰æ•ˆ

ä¸€æ—¦éªŒè¯ï¼Œå®ƒå°†åˆ—è¡¨å­˜å‚¨åœ¨é“¾ä¸Šå¹¶å‘å‡ºäº‹ä»¶ï¼Œä»¥ä¾¿å‰ç«¯å¯ä»¥åœ¨å¸‚åœºUIä¸­æ˜¾ç¤ºå®ƒã€‚

---

**ğŸ“¥ è¾“å…¥â€”â€”å‡½æ•°æ¥å—ä»€ä¹ˆ**

```solidity

function listNFT(
    address nftAddress,
    uint256 tokenId,
    uint256 price,
    address royaltyReceiver,
    uint256 royaltyPercent
)

```

| å‚æ•° | å®ƒä»£è¡¨ä»€ä¹ˆ |
| --- | --- |
| `nftAddress` | NFTçš„**ERC-721åˆçº¦**åœ°å€ |
| `tokenId` | ä½ æ­£åœ¨åˆ—å‡ºçš„NFTçš„**å”¯ä¸€ID** |
| `price` | ä½ æƒ³è¦å‡ºå”®çš„**ETHæ•°é‡ï¼ˆä»¥weiä¸ºå•ä½ï¼‰** |
| `royaltyReceiver` | åº”è¯¥åœ¨é”€å”®ä¸­æ¥æ”¶**ç‰ˆç¨**çš„åœ°å€ |
| `royaltyPercent` | ç»™äºˆå¤šå°‘ç‰ˆç¨ï¼ˆä»¥**åŸºç‚¹**ä¸ºå•ä½ï¼Œä¾‹å¦‚ï¼Œ500 = 5%ï¼‰ |

---

### ğŸ” é€è¡Œåˆ†è§£

**âœ… æ­¥éª¤1ï¼šåŸºæœ¬éªŒè¯**

```solidity

require(price > 0, "Price must be above zero");
require(royaltyPercent <= 1000, "Max 10% royalty allowed");
require(!listings[nftAddress][tokenId].isListed, "Already listed");

```

- ä½ å¿…é¡»ä»¥**éé›¶ä»·æ ¼**åˆ—å‡º
- ç‰ˆç¨å¿…é¡»**â‰¤10%**ä»¥ä¿æŒåˆç†
- NFTå¿…é¡»**å°šæœªåˆ—å‡º**ï¼ˆä»¥é¿å…è¦†ç›–æˆ–é‡å¤æ¡ç›®ï¼‰

---

**ğŸ”— æ­¥éª¤2ï¼šä¸NFTäº¤äº’**

```solidity

IERC721 nft = IERC721(nftAddress);

```

æˆ‘ä»¬å°†åœ°å€è½¬æ¢ä¸º`IERC721`åˆçº¦æ¥å£ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥è°ƒç”¨æ ‡å‡†ERC-721å‡½æ•°ï¼Œå¦‚ï¼š

- `ownerOf`
- `getApproved`
- `isApprovedForAll`

---

**ğŸ‘‘ æ­¥éª¤3ï¼šæ£€æŸ¥NFTæ‰€æœ‰æƒå’Œæ‰¹å‡†**

```solidity

require(nft.ownerOf(tokenId) == msg.sender, "Not the owner");

```

ç¡®ä¿è°ƒç”¨è€…**å®é™…æ‹¥æœ‰**ä»–ä»¬è¯•å›¾åˆ—å‡ºçš„NFTã€‚

è¿™é˜²æ­¢æœ‰äººåˆ—å‡ºä»–ä»¬ä¸æ‹¥æœ‰çš„NFTã€‚

---

```solidity

require(
    nft.getApproved(tokenId) == address(this) || nft.isApprovedForAll(msg.sender, address(this)),
    "Marketplace not approved"
);

```

å¸‚åœº**å¿…é¡»è¢«æ‰¹å‡†**ä»£è¡¨ç”¨æˆ·è½¬ç§»NFTã€‚

è¿™æ˜¯å¿…éœ€çš„ï¼Œä»¥ä¾¿åˆçº¦åœ¨å‡ºå”®æ—¶å¯ä»¥å°†NFTå‘é€ç»™ä¹°å®¶ã€‚

---

**ğŸ“¦ æ­¥éª¤4ï¼šåœ¨é“¾ä¸Šä¿å­˜åˆ—è¡¨ä¿¡æ¯**

```solidity

listings[nftAddress][tokenId] = Listing({
    seller: msg.sender,
    nftAddress: nftAddress,
    tokenId: tokenId,
    price: price,
    royaltyReceiver: royaltyReceiver,
    royaltyPercent: royaltyPercent,
    isListed: true
});

```

æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`Listing`ç»“æ„ä½“å¹¶å°†å…¶å­˜å‚¨åœ¨æˆ‘ä»¬çš„åµŒå¥—`listings`æ˜ å°„ä¸­ã€‚

è¿™ç°åœ¨æ˜¯å¸‚åœºä¸Šçš„**å®æ—¶åˆ—è¡¨**â€”â€”ä»»ä½•äººéƒ½å¯ä»¥å‘ç°ã€‚

---

**ğŸ“¢ æ­¥éª¤5ï¼šå‘å‡ºäº‹ä»¶**

```solidity

emit Listed(msg.sender, nftAddress, tokenId, price, royaltyReceiver, royaltyPercent);

```

è¿™åœ¨é“¾ä¸Šè®°å½•åˆ—è¡¨ï¼Œä»¥ä¾¿ï¼š

- UIå¯ä»¥æ˜¾ç¤ºå®ƒ
- ç´¢å¼•å™¨ï¼ˆå¦‚The Graphï¼‰å¯ä»¥è·Ÿè¸ªå®ƒ
- ç”¨æˆ·å¯ä»¥å®æ—¶çœ‹åˆ°æ´»åŠ¨

---

## 11. ğŸ›ï¸ `buyNFT()` â€” ç”¨ETHè´­ä¹°NFT

è¿™å°±æ˜¯å¸‚åœºçš„**æ ¸å¿ƒ**ã€‚

å½“æœ‰äººæ‰¾åˆ°ä»–ä»¬å–œæ¬¢çš„NFTå¹¶ç‚¹å‡»"è´­ä¹°"æ—¶ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯å®é™…è¿›è¡Œäº¤æ˜“çš„ã€‚

è®©æˆ‘ä»¬åƒå‘ç¬¬ä¸€æ¬¡è´­ä¹°NFTçš„äººè§£é‡Šä¸€æ ·èµ°è¿‡å®ƒâ€”â€”åŒæ—¶ä¹Ÿç¼–ç åç«¯ä½¿å…¶å·¥ä½œã€‚

```solidity

function buyNFT(address nftAddress, uint256 tokenId) external payable nonReentrant {
    Listing memory item = listings[nftAddress][tokenId];
    require(item.isListed, "Not listed");
    require(msg.value == item.price, "Incorrect ETH sent");
    require(
        item.royaltyPercent + marketplaceFeePercent <= 10000,
        "Combined fees exceed 100%"
    );

    uint256 feeAmount = (msg.value * marketplaceFeePercent) / 10000;
    uint256 royaltyAmount = (msg.value * item.royaltyPercent) / 10000;
    uint256 sellerAmount = msg.value - feeAmount - royaltyAmount;

    // æ”¯ä»˜å¸‚åœº
    if (feeAmount > 0) {
        payable(feeRecipient).transfer(feeAmount);
    }

    // æ”¯ä»˜åˆ›ä½œè€…ç‰ˆç¨
    if (royaltyAmount > 0 && item.royaltyReceiver != address(0)) {
        payable(item.royaltyReceiver).transfer(royaltyAmount);
    }

    // æ”¯ä»˜å–å®¶
    payable(item.seller).transfer(sellerAmount);

    // å°†NFTè½¬ç§»ç»™ä¹°å®¶
    IERC721(item.nftAddress).safeTransferFrom(item.seller, msg.sender, item.tokenId);

    // æ¸…ç†åˆ—è¡¨
    delete listings[nftAddress][tokenId];

    emit Purchase(
        msg.sender,
        nftAddress,
        tokenId,
        msg.value,
        item.seller,
        item.royaltyReceiver,
        royaltyAmount,
        feeAmount
    );
}

```

---

### ğŸ§  å®ƒåšä»€ä¹ˆï¼Ÿ

è¿™ä¸ªå‡½æ•°ï¼š

- æ¥å—ä¹°å®¶çš„ETH
- åœ¨å–å®¶ã€åˆ›ä½œè€…ï¼ˆç‰ˆç¨ï¼‰å’Œå¹³å°ï¼ˆè´¹ç”¨ï¼‰ä¹‹é—´åˆ†å‰²
- å°†NFTè½¬ç§»ç»™ä¹°å®¶
- åˆ é™¤åˆ—è¡¨
- å‘å‡ºäº‹ä»¶è®©ä¸–ç•ŒçŸ¥é“è´­ä¹°å‘ç”Ÿäº†

å…¨éƒ¨åœ¨ä¸€ä¸ªäº¤æ˜“ä¸­ã€‚æ²¡æœ‰æ‰‹åŠ¨æ­¥éª¤ã€‚æ²¡æœ‰é“¾ä¸‹ç¡®è®¤ã€‚

### ğŸ§© è®©æˆ‘ä»¬åˆ†è§£å®ƒ

---

**ğŸ›¡ï¸ å‡½æ•°å¤´**

```solidity

function buyNFT(address nftAddress, uint256 tokenId) external payable nonReentrant

```

- `external`ï¼šç”±ç”¨æˆ·ä»åˆçº¦å¤–éƒ¨è°ƒç”¨ã€‚
- `payable`ï¼šä»¥ä¾¿ä¹°å®¶å¯ä»¥å‘é€ETHã€‚
- `nonReentrant`ï¼šä½¿ç”¨`ReentrancyGuard`é˜²æ­¢é‡å…¥æ”»å‡»â€”â€”å‘é€ETHçš„å‡½æ•°ä¸­çš„å¸¸è§æ¼æ´ã€‚

---

**ğŸ“„ åŠ è½½åˆ—è¡¨**

```solidity

Listing memory item = listings[nftAddress][tokenId];

```

æˆ‘ä»¬ä»å­˜å‚¨ä¸­è·å–åˆ—è¡¨åˆ°å†…å­˜ä¸­ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥è¯»å–å…¶è¯¦ç»†ä¿¡æ¯ï¼ˆä»·æ ¼ã€å–å®¶ã€ç‰ˆç¨ä¿¡æ¯ç­‰ï¼‰ã€‚

---

**ğŸ”’ éªŒè¯**

```solidity

require(item.isListed, "Not listed");
require(msg.value == item.price, "Incorrect ETH sent");
require(
    item.royaltyPercent + marketplaceFeePercent <= 10000,
    "Combined fees exceed 100%"
);

```

- è¿™ä¸ªNFTç”šè‡³åˆ—å‡ºäº†å—ï¼Ÿ
- ä¹°å®¶æ˜¯å¦å‘é€äº†**ç¡®åˆ‡**æ‰€éœ€çš„ETHæ•°é‡ï¼Ÿ
- ç»„åˆç‰ˆç¨+å¹³å°è´¹ç”¨æ˜¯å¦ä¿æŒåœ¨100%ä»¥ä¸‹ï¼Ÿ

> æ²¡æœ‰æœ€åä¸€ä¸ªæ£€æŸ¥ï¼Œæœ‰äººå¯èƒ½å°†ç‰ˆç¨+è´¹ç”¨è®¾ç½®ä¸º110%å¹¶ç ´åæ”¯ä»˜æ•°å­¦ã€‚
> 

---

**ğŸ’° è®¡ç®—æ”¯ä»˜**

```solidity

uint256 feeAmount = (msg.value * marketplaceFeePercent) / 10000;
uint256 royaltyAmount = (msg.value * item.royaltyPercent) / 10000;
uint256 sellerAmount = msg.value - feeAmount - royaltyAmount;

```

æˆ‘ä»¬å°†æ€»ETHï¼ˆ`msg.value`ï¼‰åˆ†æˆä¸‰ä¸ªæ¡¶ï¼š

- å¸‚åœºè´¹ç”¨
- åˆ›ä½œè€…ç‰ˆç¨
- å–å®¶çš„å®é™…æ”¶å…¥

å…¨éƒ¨ä»¥**åŸºç‚¹**è®¡ç®—ï¼Œç”¨äºç²¾ç¡®çš„è´¹ç”¨é€»è¾‘ã€‚

---

### ğŸ¦ åˆ†é…èµ„é‡‘

**æ”¯ä»˜å¸‚åœº**

```solidity

if (feeAmount > 0) {
    payable(feeRecipient).transfer(feeAmount);
}

```

ETHå»`feeRecipient`â€”â€”è¿™å¯èƒ½æ˜¯å¹³å°ã€DAOï¼Œç”šè‡³å¼€å‘é’±åŒ…ã€‚

---

**æ”¯ä»˜åˆ›ä½œè€…ï¼ˆå¯é€‰ï¼‰**

```solidity

if (royaltyAmount > 0 && item.royaltyReceiver != address(0)) {
    payable(item.royaltyReceiver).transfer(royaltyAmount);
}

```

å¦‚æœåˆ—è¡¨æœ‰ç‰ˆç¨ä¿¡æ¯ï¼ŒæŒ‡å®šåœ°å€è·å¾—ä¸€éƒ¨åˆ†ã€‚

> è¿™æ”¯æŒåˆ›ä½œè€…åœ¨äºŒæ¬¡é”€å”®ä¸­çš„æ”¶å…¥â€”â€”NFTé¢†åŸŸçš„ä¸€ä¸ªå·¨å¤§åŠŸèƒ½ã€‚
> 

---

**æ”¯ä»˜å–å®¶**

```solidity

payable(item.seller).transfer(sellerAmount);

```

è´¹ç”¨å’Œç‰ˆç¨åå‰©ä¸‹çš„ä»»ä½•ä¸œè¥¿éƒ½å½’åˆ—å‡ºNFTçš„äººã€‚

---

**ğŸ“¦ è½¬ç§»NFT**

```solidity

IERC721(item.nftAddress).safeTransferFrom(item.seller, msg.sender, item.tokenId);

```

åˆçº¦ä½¿ç”¨æ ‡å‡†ERC-721è½¬ç§»å‡½æ•°**å°†NFT**ä»å–å®¶ç§»åŠ¨åˆ°ä¹°å®¶ã€‚

> è¿™åªæœ‰åœ¨å–å®¶åœ¨åˆ—è¡¨æœŸé—´æ‰¹å‡†å¸‚åœºæ—¶æ‰æœ‰æ•ˆã€‚
> 

---

**ğŸ§¹ æ¸…ç†åˆ—è¡¨**

```solidity

delete listings[nftAddress][tokenId];

```

ä¸€æ—¦NFTè¢«å‡ºå”®ï¼Œæˆ‘ä»¬ä»å­˜å‚¨ä¸­åˆ é™¤åˆ—è¡¨ï¼Œè¿™æ ·å®ƒå°±ä¸å†æ˜¾ç¤ºä¸º"å‡ºå”®"ã€‚

---

ğŸ“¢ å‘å‡ºè´­ä¹°äº‹ä»¶

```solidity

emit Purchase(
    msg.sender,
    nftAddress,
    tokenId,
    msg.value,
    item.seller,
    item.royaltyReceiver,
    royaltyAmount,
    feeAmount
);

```

è¿™è®°å½•äº¤æ˜“çš„å®Œæ•´è¯¦ç»†ä¿¡æ¯â€”â€”ä»¥ä¾¿UIå’Œç´¢å¼•å™¨å¯ä»¥è·Ÿè¸ªé”€å”®ã€è´¹ç”¨å’Œç‰ˆç¨ã€‚---

## 12. âŒ `cancelListing()` â€” ä»é”€å”®ä¸­ç§»é™¤NFT

```solidity

function cancelListing(address nftAddress, uint256 tokenId) external {
    Listing memory item = listings[nftAddress][tokenId];
    require(item.isListed, "Not listed");
    require(item.seller == msg.sender, "Not the seller");

    delete listings[nftAddress][tokenId];
    emit Unlisted(msg.sender, nftAddress, tokenId);
}

```

---

### ğŸ§  å®ƒåšä»€ä¹ˆï¼Ÿ

è¿™ä¸ªå‡½æ•°è®©NFTçš„**å–å®¶**åœ¨**å‡ºå”®ä¹‹å‰**ä»å¸‚åœºä¸­ç§»é™¤å®ƒã€‚

å®ƒåœ¨ä»¥ä¸‹æƒ…å†µä¸‹æœ‰ç”¨ï¼š

- ä½ æ”¹å˜äº†å‡ºå”®çš„æƒ³æ³•
- ä½ æƒ³ä»¥æ–°ä»·æ ¼é‡æ–°åˆ—å‡º
- ä½ æ„å¤–åˆ—å‡ºäº†é”™è¯¯çš„NFT

å‡½æ•°ç¡®ä¿**åªæœ‰åŸå§‹å–å®¶**å¯ä»¥å–æ¶ˆåˆ—å‡ºâ€”â€”ä¸€æ—¦å®Œæˆï¼ŒNFTå°†ä¸å†æ˜¾ç¤ºä¸ºå¯è´­ä¹°ã€‚

---

**ğŸ“¥ è¾“å…¥**

```solidity

(address nftAddress, uint256 tokenId)

```

å°±åƒåˆ—å‡ºæˆ–è´­ä¹°ä¸€æ ·ï¼š

- `nftAddress` = NFTçš„åˆçº¦
- `tokenId` = è¢«å–æ¶ˆåˆ—å‡ºçš„ç‰¹å®šNFT

---

### ğŸ” é€è¡Œåˆ†è§£

---

**ğŸ“„ æ­¥éª¤1ï¼šåŠ è½½åˆ—è¡¨**

```solidity

Listing memory item = listings[nftAddress][tokenId];

```

ä»å­˜å‚¨ä¸­è·å–åˆ—è¡¨è¯¦ç»†ä¿¡æ¯åˆ°å†…å­˜ä¸­ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æ£€æŸ¥å®ƒä»¬ã€‚

---

**ğŸ›¡ï¸ æ­¥éª¤2ï¼šéªŒè¯**

```solidity

require(item.isListed, "Not listed");

```

- å¦‚æœNFTæ²¡æœ‰åˆ—å‡ºï¼Œä½ ä¸èƒ½å–æ¶ˆå®ƒã€‚
- è¿™é˜²æ­¢ä¸å¿…è¦çš„åˆ é™¤æˆ–è¯¯å¯¼æ€§çš„UIæ›´æ–°ã€‚

```solidity

require(item.seller == msg.sender, "Not the seller");

```

- åªæœ‰åŸå§‹**å–å®¶**å¯ä»¥å–æ¶ˆä»–ä»¬çš„åˆ—è¡¨ã€‚
- è¿™é˜²æ­¢éšæœºç”¨æˆ·ç”šè‡³ä¹°å®¶è¯•å›¾æä¹±åˆ—è¡¨ã€‚

---

**ğŸ§¹ æ­¥éª¤3ï¼šåˆ é™¤åˆ—è¡¨**

```solidity

delete listings[nftAddress][tokenId];

```

è¿™å®Œå…¨ä»`listings`æ˜ å°„ä¸­åˆ é™¤åˆ—è¡¨ã€‚

åœ¨æ­¤ä¹‹åï¼ŒNFTä¸å†å‡ºå”®ï¼Œä¸ä¼šå‡ºç°åœ¨å‰ç«¯å¸‚åœºæˆ–APIä¸­ã€‚

---

**ğŸ“¢ æ­¥éª¤4ï¼šå‘å‡ºäº‹ä»¶**

```solidity

emit Unlisted(msg.sender, nftAddress, tokenId);

```

æˆ‘ä»¬å…¬å¼€è®°å½•æ“ä½œï¼Œè¿™è®©ï¼š

- UIå®æ—¶æ›´æ–°
- ç”¨æˆ·çœ‹åˆ°æ¸…æ™°çš„äº¤æ˜“å†å²
- ç´¢å¼•å™¨è·Ÿè¸ªåˆ—è¡¨çŠ¶æ€

## 13. ğŸ“¦ `getListing()` â€” æŸ¥çœ‹åˆ—è¡¨è¯¦ç»†ä¿¡æ¯

```solidity

function getListing(address nftAddress, uint256 tokenId) external view returns (Listing memory) {
    return listings[nftAddress][tokenId];
}

```

### ğŸ§  å®ƒåšä»€ä¹ˆ

è¿™æ˜¯ä¸€ä¸ª**åªè¯»è¾…åŠ©å‡½æ•°**ï¼Œè®©ä»»ä½•äººï¼ˆå¦‚å‰ç«¯æˆ–å¦ä¸€ä¸ªåˆçº¦ï¼‰è·å–ç‰¹å®šåˆ—è¡¨çš„è¯¦ç»†ä¿¡æ¯ã€‚

- å¤–éƒ¨è°ƒç”¨æ—¶ä¸æ¶ˆè€—gasï¼ˆå› ä¸ºå®ƒæ˜¯`view`ï¼‰
- å®ƒè¿”å›ç»™å®šNFTçš„å®Œæ•´`Listing`ç»“æ„ä½“

### ğŸ–¼ï¸ ä½ ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨å®ƒï¼Ÿ

- å¸‚åœºå‰ç«¯æƒ³è¦æ˜¾ç¤ºåˆ—å‡ºNFTçš„æ‰€æœ‰è¯¦ç»†ä¿¡æ¯
- ä¹°å®¶æƒ³è¦åœ¨è´­ä¹°å‰é¢„è§ˆä»·æ ¼å’Œç‰ˆç¨
- è„šæœ¬æˆ–æœºå™¨äººæƒ³è¦æ£€æŸ¥åˆ—å‡ºçš„å†…å®¹å¹¶è¿‡æ»¤äº¤æ˜“

---

## 14. ğŸ›‘ `receive()` â€” æ‹’ç»ç›´æ¥ETHè½¬è´¦

```solidity

receive() external payable {
    revert("Direct ETH not accepted");
}

```

### ğŸ§  å®ƒåšä»€ä¹ˆ

å½“æœ‰äºº**ç›´æ¥å‘åˆçº¦å‘é€ETH**è€Œä¸è°ƒç”¨å‡½æ•°æ—¶è§¦å‘æ­¤å‡½æ•°ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼ŒSolidityå…è®¸åˆçº¦ä»¥è¿™ç§æ–¹å¼æ¥æ”¶ETHâ€”â€”ä½†åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬**ä¸å¸Œæœ›è¿™æ ·**ã€‚

è¿™ä¸ªå‡½æ•°é€šè¿‡è°ƒç”¨`revert()`**æ‹’ç»**æ­¤ç±»è½¬è´¦ã€‚

> è¿™é˜²æ­¢ï¼š
> 
> - æ„å¤–çš„ETHè½¬è´¦
> - ç”¨æˆ·è®¤ä¸ºä»–ä»¬åªæ˜¯é€šè¿‡å‘é€ETHå°±åœ¨è´­ä¹°ä¸œè¥¿
> - ETHæ°¸è¿œå¡åœ¨åˆçº¦ä¸­

---

## 15. ğŸ§Ÿ `fallback()` â€” æ‹’ç»æœªçŸ¥å‡½æ•°è°ƒç”¨

```solidity

fallback() external payable {
    revert("Unknown function");
}

```

### ğŸ§  å®ƒåšä»€ä¹ˆ

`fallback()`å‡½æ•°åœ¨ä»¥ä¸‹æƒ…å†µä¸‹è¢«è°ƒç”¨ï¼š

- æœ‰äººè°ƒç”¨åˆçº¦ä¸­ä¸å­˜åœ¨çš„å‡½æ•°
- æˆ–åœ¨ä¸è§¦å‘`receive()`çš„æƒ…å†µä¸‹å‘é€ETH

åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬**ä¸æƒ³æ¥å—è°ƒç”¨æˆ–ETH**ï¼Œæ‰€ä»¥æˆ‘ä»¬ç«‹å³ç”¨é”™è¯¯å›æ»šã€‚

> è¿™é˜²æ­¢æ„å¤–è¯¯ç”¨ï¼Œå¹¶ç¡®ä¿ç”¨æˆ·ä¸ä¼šå› ä¸ºè°ƒç”¨åƒbyuNFT()è€Œä¸æ˜¯buyNFT()è¿™æ ·çš„æ‹¼å†™é”™è¯¯è€Œä¸¢å¤±ETHã€‚
> 

## 16. ğŸ› ï¸ åœ¨Remixä¸Šæµ‹è¯•ä½ çš„NFTå¸‚åœº

ä½ å·²ç»ç”¨æ™ºèƒ½åˆçº¦æ„å»ºäº†ä¸€ä¸ªçœŸæ­£çš„æ•°å­—å•†åº—ã€‚ç°åœ¨è®©æˆ‘ä»¬å¯åŠ¨å®ƒï¼Œçœ‹çœ‹å®ƒåœ¨Remixä¸Šçš„å®é™…è¿è¡Œã€‚

ä½ å°†èƒ½å¤Ÿï¼š

- é“¸é€ NFT
- åˆ—å‡ºå®ƒä»¬å‡ºå”®
- ä½¿ç”¨ETHè´­ä¹°å®ƒä»¬
- å–æ¶ˆåˆ—è¡¨
- å®æ—¶è§‚çœ‹ä¸€åˆ‡æ›´æ–°

---

### ğŸ“¦ æ­¥éª¤1ï¼šåŠ è½½ä½ çš„åˆçº¦

ä½ éœ€è¦**ä¸¤ä¸ªåˆçº¦**ï¼š

**1. `SimpleNFT.sol`ï¼ˆä½ ä¹‹å‰æ„å»ºçš„é‚£ä¸ªï¼‰**

> âœ… è¿™è®©ä½ å‘è‡ªå·±çš„é’±åŒ…é“¸é€ NFTã€‚
> 

---

**2. `NFTMarketplace.sol`ï¼ˆä½ çš„å¸‚åœºï¼‰**

ç²˜è´´ä½ ä¹‹å‰æ„å»ºçš„**å®Œæ•´å¸‚åœºåˆçº¦**ã€‚

âœ… ç¡®ä¿ä¸¤ä¸ªåˆçº¦éƒ½ä½¿ç”¨Solidityç¼–è¯‘å™¨æ ‡ç­¾ç¼–è¯‘æ— é”™è¯¯ã€‚

---

### ğŸš€ æ­¥éª¤2ï¼šéƒ¨ç½²åˆçº¦

1. è½¬åˆ°Remixä¸­çš„**Deploy & Run**æ ‡ç­¾ã€‚
2. å°†**Environment**è®¾ç½®ä¸º`Remix VM (London)`ï¼ˆç”¨äºæœ¬åœ°æµ‹è¯•ï¼‰ã€‚
3. éƒ¨ç½²`SimpleNFT`â€”â€”å¤åˆ¶å…¶åœ°å€ã€‚
4. ä½¿ç”¨è¿™äº›æ„é€ å‡½æ•°å€¼éƒ¨ç½²`NFTMarketplace`ï¼š
    - è´¹ç”¨ç™¾åˆ†æ¯”ï¼š`250`ï¼ˆ2.5%ï¼‰
    - è´¹ç”¨æ¥æ”¶è€…ï¼šä½ è‡ªå·±çš„Remixé’±åŒ…åœ°å€ï¼ˆä½ ä¼šåœ¨å³ä¸Šè§’çœ‹åˆ°å®ƒï¼‰

---

### ğŸ¨ æ­¥éª¤3ï¼šé“¸é€ ä¸€äº›NFT

1. å±•å¼€ä½ éƒ¨ç½²çš„`SimpleNFT`åˆçº¦ã€‚
2. è°ƒç”¨`mint()`å‡½æ•°ä¸¤æ¬¡ä»¥é“¸é€ ä¸¤ä¸ªNFTï¼ˆID 0å’Œ1ï¼‰ã€‚
3. è°ƒç”¨`ownerOf(0)`å’Œ`ownerOf(1)`ä»¥ç¡®è®¤ä½ æ‹¥æœ‰å®ƒä»¬ã€‚

---

### âœ… æ­¥éª¤4ï¼šæ‰¹å‡†å¸‚åœº

åœ¨å¸‚åœºå¯ä»¥åˆ—å‡ºæˆ–å‡ºå”®ä½ çš„NFTä¹‹å‰ï¼Œä½ éœ€è¦**æ‰¹å‡†**å®ƒã€‚

1. åœ¨`SimpleNFT`ä¸­ï¼Œè°ƒç”¨ï¼š
    - `setApprovalForAll(marketplaceAddress, true)`
    - ï¼ˆç”¨ä½ éƒ¨ç½²çš„å¸‚åœºçš„å®é™…åœ°å€æ›¿æ¢`marketplaceAddress`ï¼‰

---

### ğŸ·ï¸ æ­¥éª¤5ï¼šåˆ—å‡ºNFTå‡ºå”®

ç°åœ¨è½¬åˆ°ä½ éƒ¨ç½²çš„`NFTMarketplace`åˆçº¦ã€‚

1. ä½¿ç”¨ä»¥ä¸‹å‚æ•°è°ƒç”¨`listNFT()`ï¼š
    - `nftAddress`ï¼šä½ çš„`SimpleNFT`åˆçº¦åœ°å€
    - `tokenId`ï¼š`0`
    - `price`ï¼š`1000000000000000000`ï¼ˆè¿™æ˜¯1 ETHä»¥weiä¸ºå•ä½ï¼‰
    - `royaltyReceiver`ï¼šä½ è‡ªå·±çš„åœ°å€
    - `royaltyPercent`ï¼š`500`ï¼ˆ5%ï¼‰

**âœ… è¿™ä¸ªNFTç°åœ¨æ˜¯å®æ—¶åˆ—å‡ºçš„ã€‚**

---

### ğŸ›’ æ­¥éª¤6ï¼šè´­ä¹°NFT

åœ¨Remixä¸­åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè´¦æˆ·ï¼ˆå³ä¸Šè§’ä¸‹æ‹‰èœå•ï¼‰ã€‚

åœ¨**Marketplaceåˆçº¦**ä¸­ï¼Œä½¿ç”¨ä»¥ä¸‹å‚æ•°è°ƒç”¨`buyNFT()`ï¼š

- `nftAddress`ï¼šä½ çš„`SimpleNFT`åœ°å€
- `tokenId`ï¼š`0`

ğŸ‘‡ åœ¨è°ƒç”¨æŒ‰é’®ä¸Šæ–¹çš„å€¼å­—æ®µä¸­ï¼š

- è¾“å…¥`1` ETHï¼š`1000000000000000000`

âœ… ç °â€”â€”ä½ çš„NFTè¢«è´­ä¹°äº†ï¼

- å–å®¶å¾—åˆ°äº†æŠ¥é…¬
- ç‰ˆç¨å½’åˆ›ä½œè€…
- è´¹ç”¨å½’å¹³å°
- NFTè½¬ç§»ç»™ä¹°å®¶

---

### âŒ æ­¥éª¤7ï¼šå°è¯•å–æ¶ˆåˆ—è¡¨

- å†æ¬¡é“¸é€ ç¬¬ä¸‰ä¸ªNFTï¼ˆå†æ¬¡`mint()`ï¼‰ã€‚
- å¦‚æœéœ€è¦ï¼Œæ‰¹å‡†å¸‚åœºã€‚
- åˆ—å‡º`tokenId 2`ã€‚

ç„¶åä½¿ç”¨ä»¥ä¸‹å‚æ•°è°ƒç”¨`cancelListing()`ï¼š

- `nftAddress`
- `tokenId`ï¼š`2`

âœ… ä½ ä¼šçœ‹åˆ°åˆ—è¡¨æ¶ˆå¤±ï¼ˆé€šè¿‡`getListing()`æ£€æŸ¥ï¼‰ã€‚

---

### ğŸ§  å¯é€‰è°ƒè¯•æç¤º

- ä½¿ç”¨`getListing(nftAddress, tokenId)`æŸ¥çœ‹åˆ—è¡¨ä¿¡æ¯
- åœ¨`SimpleNFT`ä¸­ä½¿ç”¨`ownerOf(tokenId)`è·Ÿè¸ªNFTè½¬ç§»
- æ£€æŸ¥Remix**æ§åˆ¶å°æ—¥å¿—å’Œäº¤æ˜“**ä»¥äº†è§£æ‰€æœ‰ETHç§»åŠ¨

---

## ğŸ‰ ä½ åšåˆ°äº†

ä½ åˆšåˆšï¼š

- é“¸é€ äº†NFT
- åˆ—å‡ºå®ƒä»¬å‡ºå”®
- ç”¨ç‰ˆç¨å’Œè´¹ç”¨è´­ä¹°äº†å®ƒä»¬
- å–æ¶ˆäº†åˆ—è¡¨
- å®Œå…¨æµ‹è¯•äº†ä½ è‡ªå·±çš„é“¾ä¸ŠNFTå•†åº—

å…¨éƒ¨æ— éœ€åç«¯ã€æ•°æ®åº“æˆ–å‰ç«¯ã€‚